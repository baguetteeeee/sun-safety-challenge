<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mela vs UV Villain</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #e0f7fa;
  }
  #gameArea {
    position: relative;
    width: 600px;
    height: 400px;
    margin: 20px auto;
    border: 2px solid #333;
    background: white;
    overflow: hidden;
  }
  #mela, #villain {
    position: absolute;
    width: 80px;
    height: 80px;
  }
  #mela {
    bottom: 10px;
    left: 260px;
  }
  #villain {
    top: 10px;
    left: 260px;
  }
  .ray {
    position: absolute;
    width: 10px;
    height: 40px;
    background: orange;
    top: 100px;
    left: 295px;
  }
  #buttons {
    margin-top: 20px;
  }
  button {
    padding: 10px 15px;
    margin: 0 10px;
    font-size: 16px;
  }
  #message {
    margin-top: 15px;
    font-weight: bold;
  }
  .health-container {
    width: 200px;
    height: 20px;
    border: 2px solid #333;
    margin: 10px auto;
    background: #eee;
  }
  .health-bar {
    height: 100%;
    width: 100%;
    background: green;
  }
</style>
</head>
<body>

<h1>Mela vs UV Villain</h1>

<div class="health-container">UV Villain</div>
<div id="villainHealthBar" class="health-bar"></div>

<div id="gameArea">
  <img id="mela" src="https://heyclipart.com/cdn/shop/files/2-mole-in-hole-vector-cartoon-illustration-42.jpg" alt="Mela">
  <img id="villain" src="https://st2.depositphotos.com/3250055/8394/v/950/depositphotos_83944362-stock-illustration-evil-cartoon-sun.jpg" alt="UV Villain">
</div>

<div class="health-container">Mela</div>
<div id="melaHealthBar" class="health-bar" style="background: blue;"></div>

<div id="buttons"></div>

<div id="message"></div>

<script>
let villainHealth = 3;
let melaHealth = 3;
let rayInterval;
let activeRay = null;

// Correct and wrong options
const correctOptions = ["Sunscreen âœ…", "Hat âœ…", "Shade âœ…", "Sunglasses âœ…"];
const wrongOptionsPool = [
  "Wear short sleeves", "Jump in a puddle", "Eat ice cream", "Dance in the sun", "Cover eyes with hands", "Sit on the grass", "Drink water"
];

// Create UV ray
function startRay() {
  const gameArea = document.getElementById('gameArea');
  const ray = document.createElement('div');
  ray.classList.add('ray');
  gameArea.appendChild(ray);
  activeRay = ray;
  
  let topPos = 100;
  const fall = setInterval(() => {
    if (topPos >= 350) {
      clearInterval(fall);
      gameArea.removeChild(ray);
      activeRay = null;
      melaHealth--;
      updateHealthBars();
      showMessage('UV hit Mela! ðŸ˜¢', 'red');
      checkGameOver();
    } else {
      topPos += 5;
      ray.style.top = topPos + 'px';
    }
  }, 30);
}

// Set randomized buttons
function setButtons() {
  const buttonsDiv = document.getElementById('buttons');
  buttonsDiv.innerHTML = "";

  // Pick 1 correct option
  const correct = correctOptions[Math.floor(Math.random() * correctOptions.length)];

  // Pick 2 unique wrong options
  let options = [correct];
  while (options.length < 3) {
    let rand = wrongOptionsPool[Math.floor(Math.random() * wrongOptionsPool.length)];
    if (!options.includes(rand)) options.push(rand);
  }

  // Shuffle
  options.sort(() => Math.random() - 0.5);

  // Create buttons
  options.forEach(opt => {
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.onclick = () => protect(opt);
    buttonsDiv.appendChild(btn);
  });
}

// Handle protection
function protect(option) {
  if (!activeRay) return; 
  if (correctOptions.includes(option)) {
    const ray = activeRay;
    activeRay = null;
    // animate ray bounce back
    let pos = parseInt(ray.style.top);
    const bounce = setInterval(() => {
      if (pos <= 10) {
        clearInterval(bounce);
        ray.remove();
        villainHealth--;
        updateHealthBars();
        checkGameOver();
      } else {
        pos -= 5;
        ray.style.top = pos + 'px';
        ray.style.background = 'red';
      }
    }, 20);
    showMessage('Blocked the UV ray! ðŸ˜Ž', 'green');
  } else {
    showMessage('Wrong choice! UV got through! ðŸ˜¢', 'red');
  }
}

function updateHealthBars() {
  document.getElementById('villainHealthBar').style.width = (villainHealth/3*100) + "%";
  document.getElementById('melaHealthBar').style.width = (melaHealth/3*100) + "%";
}

function checkGameOver() {
  if (villainHealth <= 0) {
    showMessage('Mela defeated the UV Villain! ðŸŽ‰', 'blue');
    clearInterval(rayInterval);
  } else if (melaHealth <= 0) {
    showMessage('Mela got defeated! ðŸ˜¢', 'red');
    clearInterval(rayInterval);
  } else {
    setButtons();
  }
}

// Initialize
setButtons();
rayInterval = setInterval(startRay, 3000);

function showMessage(text, color) {
  const msg = document.getElementById('message');
  msg.textContent = text;
  msg.style.color = color;
}
</script>

</body>
</html>
